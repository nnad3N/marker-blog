---
import { payloadFetch } from "@/data/payload";

import DynamicBlocks from "@/components/DynamicBlocks.astro";
import Layout from "@/layouts/Layout.astro";
import type { Page } from "payload/generated-types";
import type { GetStaticPaths } from "astro";

export const getStaticPaths: GetStaticPaths = async () => {
  const data = await payloadFetch<Page[]>("pages?depth=2");

  if (!data) return [];

  return data.docs.map(({ slug, content }) => ({
    params: { slug: slug || undefined },
    props: { content },
  }));
};

type Props = {
  content: Page["content"];
};

const { content } = Astro.props;
---

<Layout class="py-12 lg:py-24">
  <DynamicBlocks blocks={content} />
</Layout>
